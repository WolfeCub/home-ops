---
apiVersion: v1
kind: Service
metadata:
  name: envoy
  namespace: pomerium
spec:
  type: ExternalName
  externalName: 'localhost'
  ports:
    - protocol: TCP
      name: admin
      port: 9901
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: envoy
  namespace: pomerium
  annotations:
    ingress.pomerium.io/policy: ${pom_admin_group}
spec:
  ingressClassName: pomerium
  rules:
    - host: 'envoy.joshwolfe.ca'
      http:
        paths:
          - pathType: Prefix
            path: /
            backend:
              service:
                name: envoy
                port:
                  name: admin
