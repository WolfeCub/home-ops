version: "3.5"
services:
  plex:
    image: linuxserver/plex
    ports:
      - 32400:32400
      - 32400:32400/udp
      - 32469:32469
      - 32469:32469/udp
      - 5353:5353/udp
      - 1900:1900/udp
    networks:
      - webnet
    volumes:
      - /plexconfig:/config:Z
      - /storage/media/tv-shows:/data/tvshows:Z
      - /storage/media/movies:/data/movies:Z
      - /storage/homelab/plextranscode:/transcode:Z
    labels:
      - traefik.backend=plex
      - traefik.frontend.rule=Host:plex.house20.ca
      - traefik.port=32400
      - traefik.docker.network=webnet
      - traefik.frontend.redirect.entryPoint=https
    environment:
      - PUID=1002
      - PGID=1003

  tautulli:
    image: linuxserver/tautulli
    networks:
      - webnet
    volumes:
      - "/plexconfig/Library/Application Support/Plex Media Server/Logs:/logs:ro"
      - /tautulliconfig:/config:Z
    labels:
      - traefik.backend=tautulli
      - traefik.frontend.rule=Host:tautulli.house20.ca
      - traefik.port=8181
      - traefik.docker.network=webnet
      - traefik.frontend.redirect.entryPoint=https
    environment:
      - PUID=1002
      - PGID=1003

  sonarr:
    image:  linuxserver/sonarr:latest
    networks:
      - webnet
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - /storage/media/tv-shows:/tv
      - /storage/homelab/sonarrconfig:/config
      - /storage/homelab/transmission/downloads/complete:/downloads
      #- /storage/homelab/nzbgetdownloads:/downloads
    labels:
      - traefik.backend=sonarr
      - traefik.frontend.rule=Host:sonarr.house20.ca
      - traefik.port=8989
      - traefik.docker.network=webnet
      - traefik.frontend.redirect.entryPoint=https
    environment:
      - PUID=1002
      - PGID=1003

  radarr:
    image:  linuxserver/radarr:latest
    networks:
      - webnet
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - /storage/media/movies:/movies
      - /storage/homelab/radarrconfig:/config
      - /storage/homelab/transmission/downloads/complete:/downloads
      #- /storage/homelab/nzbgetdownloads:/downloads
    labels:
      - traefik.backend=radarr
      - traefik.frontend.rule=Host:radarr.house20.ca
      - traefik.port=7878
      - traefik.docker.network=webnet
      - traefik.frontend.redirect.entryPoint=https
    environment:
      - PUID=1002
      - PGID=1003

  jackett:
    image:  linuxserver/jackett:latest
    networks:
      - webnet
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - /storage/homelab/jackett/config:/config
      - /storage/homelab/jackett/downloads:/downloads
    labels:
      - traefik.backend=jackett
      - traefik.frontend.rule=Host:jackett.house20.ca
      - traefik.port=9117
      - traefik.docker.network=webnet
      - traefik.frontend.redirect.entryPoint=https
    environment:
      - PUID=1002
      - PGID=1003

networks:
  webnet:
    external: true
